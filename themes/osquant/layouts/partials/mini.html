{{ $readTime := mul (div (countwords .Content) 220.0) 60 }}
{{ $minutes := math.Round (div $readTime 60) }}

{{ $images := $.Resources.ByType "image" }}
{{ $featured := $images.GetMatch "*feature*" }}

<div class="mini {{ if .Params.feature }}feature{{ end }}">
    <div>
        {{ if .Params.feature }}
            {{ with $featured }}
                <a href="{{ .Permalink }}"><img src="{{ $featured.Permalink }}" /></a>
            {{ end }}
        {{ end }}
    </div>
    <div class="author">
        {{ with (.GetTerms "authors") }}
            {{ $links := apply . "partial" "author-link.html" "." }}
            {{ $clean := apply $links "chomp" "." }}
            {{ delimit $clean ", " " & " }}
        {{ end }}

        {{ if and .Params.authors (.GetTerms "categories") }}
        <sep>in</sep>
        {{ end }}

        {{ partial "category-links.html" . }}
    </div>
    <a class="title" href="{{ .Permalink }}">{{ .Title }}</a>
    <div class="blurb">{{ .Summary }}</div>
    <div class="meta">
        <span class="date">{{ .Date.Format "Jan 2, 2006" }}</span>
        <span class="space">·</span>
        <span>{{ $minutes }} min read</span>
        <!-- {{ if (.GetTerms "tags") }}<span class="space">·</span>{{ end }}
        {{ range (.GetTerms "tags") }}
            <a class="tag" href="{{ .Permalink }}">{{ .LinkTitle }}</a>
        {{ end }} -->
        {{ if .Params.draft }}<span class="tag">Draft</span>{{ end }}
    </div>
</div>